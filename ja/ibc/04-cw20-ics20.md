# CW20 ICS20

## 仕様

これは* IBC対応*契約であり、標準のICS20を介してチェーンからCW20トークンを送信できます.
別のチェーンの銀行モジュールとの合意.つまり、IBCを使用してカスタムCW20トークンを送信し、
それらは他のチェーンのネイティブトークンのようなものです.

トークンを送信し、以前に送信されたトークンを引き換えるためにのみ使用されます.所属はキャストされません
外部チェーンから派生したアセット.これはGolangの `ibctransfer`モジュールとは異なりますが、
ICS20を正しく実装し、エラーメッセージで応答しました... Go側がこの問題を正しく処理することを期待しましょう.

### 作業過程

契約は最小の状態から始まります.送信するすべてのパケットのデフォルトのタイムアウトを秒単位で保存するだけです.
最も重要なことは、ローカルIBCポートをバインドして、チャネル接続を有効にすることです.

外部パーティは、最初にこのコントラクトをエンドポイントとして使用して、1つ以上のチャネルを作成する必要があります.標準のics20を使用します
バージョンネゴシエーションに使用されるアウトオブオーダーチャネル.確立されると、既知のチャネルのリストを管理します.あなたはそれを使うことができます
[ts-relayer](https://github.com/confio/ts-relayer)これらを作成するための `ibc-setupics20`コマンド.

少なくとも1つのチャネルを取得したら、合格できます
[受信者モード](https://github.com/CosmWasm/cosmwasm-plus/blob/master/packages/cw20/README.md#receiver).
受信したメッセージには、送信するチャネルと送信先のリモートアドレスが含まれている必要があります.選べます
カスタムタイムアウトを含みます.

### 情報

cw20コントラクトからのCW20ReceiveMsgのみを受け入れます.メッセージとともに送信されるデータは、JSONでシリアル化する必要があります
メッセージを送る:

```rust
pub struct TransferMsg {
   ///The local channel to send the packets on
    pub channel: String,
   ///The remote address to send to
   ///Don't use HumanAddress as this will likely have a different Bech32 prefix than we use
   ///and cannot be validated locally
    pub remote_address: String,
   ///How long the packet lives in seconds. If not specified, use default_timeout
    pub timeout: Option<u64>,
}
```

さらに、 `ExecuteMsg :: Transfer(TransferMsg)`を介したネイティブトークンの直接送信をサポートします.
送金メッセージと一緒に送信する必要があります*正確に1つ*コイン建てで、金額が送金されます
リモートホストへ.

### お問い合わせ

クエリは、この契約の確立されたチャネルに関連してのみ意味があります.

* `Port {}`-チャネルを作成できるように、このコントラクトにバインドされたポートIDを返します.この情報を照会できます
  wasmd契約情報を介してクエリを実行しますが、便宜上、ここで別のクエリを公開しました.
* `ListChannels {}`-このコントラクトで作成されたすべてのチャネルの(現在ページ化されていない)リストを返します.
  ローカルchannelIdと、リモートポート/チャネルや接続などのいくつかの基本的なメタデータを返します
  その上で実行します.
* `Channel {id}`-特定のチャネルに関するより詳細な情報を返します.既存の情報に加えて
  リストビューでは、チャネルの現在の未払い残高と合計金額が返されます
  チャンネルで送信されました.

### IBC応答

これらはICS20仕様で定義されています.

各チャネルには、チャネルを介して送信されるトークン残高があることに注意してください.着信転送要求が着信した場合
金額がわからない場合、または残高が送信した残高よりも多い場合は、確認でエラーが返されます
バッグ.

## デモ

**開発中**
